Элемент управления RichTextBox используется для
отображения, ввода и изменения текста с форматирова-
нием. Иерархия наследования класса RichTextBox:
System.Object
System.MarshalByRefObject
System.ComponentModel.Component
System.Windows.Forms.Control
System.Windows.Forms.TextBoxBase
Элемент управления RichTextBox выполняет те же
функции, что и элемент управления TextBox, но помимо
этого он позволяет отображать шрифты, цвета и ссылки,
загружать текст и вложенные изображения из файлов,
а также осуществлять поиск. Для текста элемента управ-
ления RichTextBox можно назначить формат символов
и абзацев. Элемент управления RichTextBox обычно ис-
пользуется для предоставления возможностей изменения
и отображения текста, схожих с возможностями текстовых
редакторов, таких как Microsoft Word.
Элемент управления RichTextBox содержит множество
свойств, которые можно использовать при примене-
нии форматирования к любой части текста в элементе
управления. Перед тем как изменить форматирование
текста, этот текст необходимо выделить. Только к вы-
деленному тексту можно применить форматирование
символов и абзацев. После того как выделенному тексту
после выделенного, будет форматирован с учетом того
же параметра, пока этот параметр не будет изменен,
или не будет выделена другая часть документа элемента
управления. Свойство SelectionFont
позволяет выде-
лять текст полужирным шрифтом или курсивом.Кроме
того, с помощью этого свойства можно изменять раз-
мер и шрифт текста. Свойство SelectionColor
позволяет
изменять цвет текста. Для создания маркированных
списков следует использовать свойство SelectionBullet.
Настройка форматирования абзацев осуществляется
также с помощью свойств SelectionIndent, SelectionRightIndent
и SelectionHangingIndent.
Элемент управления RichTextBox, как и TextBox, по-
зволяет отображать полосы прокрутки, однако в отличие
от TextBox, он по умолчанию отображает и горизонталь-
ную, и вертикальную полосы прокрутки в зависимости от
необходимости, а также поддерживает дополнительные
параметры их настройки. Как и для элемента управления
TextBox, отображаемый текст задается свойством Text.
в элементе управления RichTextBox содержится множе-
ство свойств для форматирования текста. Для управления
файлами используются методы LoadFile и SaveFile:
LoadFile(String) /* Загружает файл в формате RTF
или стандартный текстовый файл в кодировке ASCII
в элемент управления RichTextBox.*/
SaveFile(String) /* Сохраняет содержимое элемента
управления RichTextBox в RTF-файл.*/
Методы LoadFile и SaveFile отображают и сохраняют
множество форматов файлов, в том числе обычный текст,
обычный текст Юникод и форматируемый текст (RTF).
с помощью метода Find выполняется поиск текстовых
строк или определенных символов:
Find(Char[], Int32)
/* с заданной начальной позиции осуществляет поиск
первого экземпляра символа из списка символов по
тексту элемента управления RichTextBox. */
Find(String, RichTextBoxFinds)
/* Осуществляет поиск в элементе управления
RichTextBox текстовой строки с определенными
параметрами, примененными к поиску.*/
Find(Char(), Int32, Int32)
/* Осуществляет поиск первого экземпля ра символа из
списка символов по отрезку текста элемента управления
RichTextBox.*/
Find(String, Int32, RichTextBoxFinds)
/* Осуществляет поиск тексто вой строки
в определенном месте текста элемента управления
RichTextBox с примененными к поиску параметрами.*/
Find(String, Int32, Int32, RichTextBoxFinds)
/* Осуществляет поиск текстовой строки в определенном
отрезке текста элемента управления RichTextBox
с примененными к поиску параметрами.*/
Элемент управления RichTextBox можно также ис-
пользовать для создания веб-ссылок; для этого надо за-
дать для свойства DetectUrls значение true и создать код
для обработки события LinkClicked. Можно запретить
пользователю управлять частью текста или всем текстом
в элементе управления, задав для свойства SelectionProtected
значение true.
Большую часть операций редактирования в элементе
управления RichTextBox можно отменить и восстановить
с помощью вызова методов Undo и Redo. Метод CanRedo
позволяет определить, можно ли заново применить вы-
полненное последним и отмененное действие, к элементу
управления.
Как известно, слово Rich можно перевести с английского
языка как богатый. в контексте этого раздела нашего урока
это означает богатство возможностей форматирования
текста по сравнению с обычным элементом управления
TextBox. с полным списком этих возможностей можно
ознакомиться в MSDN.
Рассмотрим работу элемента управления RichTextBox на
примере приложения SimplyNotepadCSharp (исходный код
приложения находится в архиве прикрепленном к PDF-фай-
лу данного урока, папка SOURSE/SimplyNotepadCSharp).
Приложение SimplyNotepadCSharp напоминает приложе-
ние Windows notepad и позволяетформатировать текст.